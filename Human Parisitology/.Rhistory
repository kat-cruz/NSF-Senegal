# 1) Calculate S. haematobium egg count
mutate(
sh_egg_count = if_else(fu_p1 > 0, fu_p1, fu_p2),  # max of fu_p1 and fu_p2, only use fu_p2 if fu_p1 is zero
#  2) Calculate S. mansoni egg count
# Calculate average of each pass
p1_avg = (p1_kato1_k1_pg + p1_kato2_k2_peg) / 2,
p2_avg = (p2_kato1_k1_epg + p2_kato2_k2_epg) / 2,
# Only calculate p2_avg if p1_avg is zero, then take the maximum of p1_avg and p2_avg
sm_egg_count = if_else(p1_avg > 0, p1_avg, p2_avg)
)# %>%
#Change variables to factors
matched_only_df <- matched_only_df %>%
mutate(
health_5_3_2_ = as.factor(health_5_3_2_),
health_5_5_ = as.factor(health_5_5_),
health_5_6_ = as.factor(health_5_6_),
health_5_8_ = as.factor(health_5_8_),
health_5_9_ = as.factor(health_5_9_),
health_5_10_ = as.factor(health_5_10_)
)
str(matched_only_df$sm_egg_count)
table(matched_only_df$sm_egg_count)
summary(matched_only_df$sm_egg_count)
#output of regression table
# stargazer(production_reg,
#           title ="Precision",
#           type = "text",
#           report = "vc*s",
#           #model.numbers=FALSE,
#           covariate.labels = c("Heat", "Male", "Time", "Heat X Time ", "Height", "Height (Missing)"),
#           dep.var.labels = "",
#           column.labels = regression_names,
#           no.space = TRUE,
#           column.sep.width = "3pt",
#           se = production_reg_pvals,
#           p = production_reg_pvals,
#           omit.stat = c("f", "adj.rsq", "ser")
#           #omit = c("height_reg", "height_reg_miss")
# Specify the formula for logistic regression
formula <- sh_inf ~ health_5_3_2_ + health_5_4_
# Run the logistic regression
logit_model <- glm(formula, data = matched_only_df, family = binomial)
#covariate_labels <- c("Perception", "Recently infected")
# Display summary of the model
stargazer(logit_model,
covariate.labels = c("Percieved infection", "Missed school days"),
#dep.var.labels = "",
type = "text",
digit.separator = "",
no.space = TRUE,
column.sep.width = "3pt")  # Omit some statistics
# Specify the formula for logistic regression
formula <- sh_inf ~ health_5_3_2_ + health_5_4_ + health_5_5_ + health_5_6_
# Run the logistic regression
logit_model2 <- glm(formula, data = matched_only_df, family = binomial)
#covariate_labels <- c("Perception", "Recently infected")
# Display summary of the model
stargazer(logit_model2,
covariate.labels = c("Percieved infection", "Missed school days", "Recived medication", "Ever diagnosed with Bilharzia"),
#dep.var.labels = "",
type = "text",
digit.separator = "",
no.space = TRUE,
column.sep.width = "3pt")  # Omit some statistics
# Extract coefficients
coefficients <- coef(logit_model2)
# Calculate odds ratios
odds_ratios <- exp(coefficients)
# Display odds ratios
odds_ratios
stargazer(odds_ratios)
stargazer(odds_ratios,
type = "text")
# Display odds ratios
stargazer(odds_ratios,
covariate.labels = c("Percieved infection", "Missed school days", "Recived medication", "Ever diagnosed with Bilharzia"),
type = "text")
odds_ratios
stargazer(odds_ratios,
covariate.labels = c("Intercept", "Percieved infection", "Missed school days", "Recived medication", "Ever diagnosed with Bilharzia"),
type = "text")
# Calculate confidence intervals for coefficients
conf_int <- confint(logit_model2)
# Exponentiate to get confidence intervals for odds ratios
conf_int_odds_ratios <- exp(conf_int)
# Display odds ratios with confidence intervals
data.frame(Odds_Ratio = odds_ratios,
CI_Lower = conf_int_odds_ratios[, 1],
CI_Upper = conf_int_odds_ratios[, 2])
stargazer(data.frame(Odds_Ratio = odds_ratios,
CI_Lower = conf_int_odds_ratios[, 1],
CI_Upper = conf_int_odds_ratios[, 2]))
logit_reg2 <- data.frame(Odds_Ratio = odds_ratios,
CI_Lower = conf_int_odds_ratios[, 1],
CI_Upper = conf_int_odds_ratios[, 2])
stargazer(logit_reg2,
type = "text")
# Specify the formula for logistic regression
formula_01 <- sh_inf ~ health_5_3_2_ + health_5_4_
# Run the logistic regression
logit_model_01 <- glm(formula, data = matched_only_df, family = binomial)
#covariate_labels <- c("Perception", "Recently infected")
# Display summary of the model
stargazer(logit_model_01,
covariate.labels = c("Percieved infection", "Missed school days"),
#dep.var.labels = "",
type = "text",
digit.separator = "",
no.space = TRUE,
column.sep.width = "3pt")  # Omit some statistics
# Extract coefficients
coefficients_01 <- coef(logit_model_01)
# Calculate odds ratios
odds_ratios_01 <- exp(coefficients_01)
# Display odds ratios
stargazer(odds_ratios_01,
covariate.labels = c("Intercept", "Percieved infection", "Missed school days", "Recived medication", "Ever diagnosed with Bilharzia"),
type = "text")
# Calculate confidence intervals for coefficients
conf_int_01 <- confint(logit_model_01)
# Exponentiate to get confidence intervals for odds ratios
conf_int_odds_ratios_01 <- exp(conf_int_01)
# Display odds ratios with confidence intervals
logit_reg_01 <- data.frame(Odds_Ratio = odds_ratios_01,
CI_Lower = conf_int_odds_ratios[, 1],
CI_Upper = conf_int_odds_ratios[, 2])
stargazer(logit_reg_01,
type = "text")
getwd()
setwd("C:\Users\km978\Box\NSF Senegal\Data Management\Output\Data Analysis\Parasitological Predictive Tables")
setwd("C:/Users/km978/Box/NSF Senegal/Data Management/Output/Data Analysis/Parasitological Predictive Tables")
setwd("C:/Users/km978/Box/NSF Senegal/Data Management/Output/Data Analysis/Parasitological Predictive Tables")
# Specify the formula for logistic regression
formula_01 <- sh_inf ~ health_5_3_2_ + health_5_4_
# Run the logistic regression
logit_model_01 <- glm(formula, data = matched_only_df, family = binomial)
#covariate_labels <- c("Perception", "Recently infected")
# Display summary of the model
stargazer(logit_model_01,
covariate.labels = c("Percieved infection", "Missed school days"),
#dep.var.labels = "",
type = "latex",
digit.separator = "",
no.space = TRUE,
column.sep.width = "3pt",
out = "logit_model_01_table.tex")  # Omit some statistics
# Extract coefficients
coefficients_01 <- coef(logit_model_01)
# Calculate odds ratios
odds_ratios_01 <- exp(coefficients_01)
# Display odds ratios
stargazer(odds_ratios_01,
covariate.labels = c("Intercept", "Percieved infection", "Missed school days", "Recived medication", "Ever diagnosed with Bilharzia"),
type = "text",
out = "odds_ratios_01.tex")
# Calculate confidence intervals for coefficients
conf_int_01 <- confint(logit_model_01)
# Exponentiate to get confidence intervals for odds ratios
conf_int_odds_ratios_01 <- exp(conf_int_01)
# Display odds ratios with confidence intervals
CI_odds_01 <- data.frame(Odds_Ratio = odds_ratios_01,
CI_Lower = conf_int_odds_ratios[, 1],
CI_Upper = conf_int_odds_ratios[, 2])
stargazer(logit_reg_01,
type = "text",
out = "CI_odds_01.tex")
odds_ratios_long <- data.frame(
Variable = c("Intercept",
"Perceived infection",
"Missed school days",
"Received medication",
"Ever diagnosed with Bilharzia"),
Odds_Ratio = odds_ratios_02
)
# Specify the formula for logistic regression
formula_02 <- sh_inf ~ health_5_3_2_ + health_5_4_ + health_5_5_ + health_5_6_
# Run the logistic regression
logit_model_02 <- glm(formula, data = matched_only_df, family = binomial)
#covariate_labels <- c("Perception", "Recently infected")
# Display summary of the model
stargazer(logit_model_02,
covariate.labels = c("Percieved infection", "Missed school days", "Recived medication", "Ever diagnosed with Bilharzia"),
#dep.var.labels = "",
type = "text",
digit.separator = "",
no.space = TRUE,
column.sep.width = "3pt",
out = "logit_model_02_table.tex")  # Omit some statistics
# Extract coefficients
coefficients_02 <- coef(logit_model_02)
# Calculate odds ratios
odds_ratios_02 <- exp(coefficients_02)
# Display odds ratios
stargazer(odds_ratios_02,
covariate.labels = c("Intercept", "Percieved infection", "Missed school days", "Recived medication", "Ever diagnosed with Bilharzia"),
type = "text",
out = "odds_ratios_02.tex")
# Calculate confidence intervals for coefficients
conf_int <- confint(logit_model_02)
# Exponentiate to get confidence intervals for odds ratios
conf_int_odds_ratios_02 <- exp(conf_int)
# Display odds ratios with confidence intervals
CI_odds_02 <- data.frame(Odds_Ratio = odds_ratios_02,
CI_Lower = conf_int_odds_ratios_02[, 1],
CI_Upper = conf_int_odds_ratios_02[, 2])
stargazer(CI_odds_02,
type = "text",
out = "CI_odds_02.tex")
odds_ratios_long <- data.frame(
Variable = c("Intercept",
"Perceived infection",
"Missed school days",
"Received medication",
"Ever diagnosed with Bilharzia"),
Odds_Ratio = odds_ratios_02
)
# Use stargazer for a "long" table
stargazer(odds_ratios_long,
summary = FALSE,   # Suppresses summary statistics
type = "text",
rownames = FALSE)#,  # Removes row numbers
#out = "odds_ratios_long.tex")
# Specify the formula for logistic regression
formula_02 <- sh_inf ~ health_5_3_2_ + health_5_4_ + health_5_5_ + health_5_6_
# Run the logistic regression
logit_model_02 <- glm(formula, data = matched_only_df, family = binomial)
#covariate_labels <- c("Perception", "Recently infected")
# Display summary of the model
stargazer(logit_model_02,
covariate.labels = c("Percieved infection", "Missed school days", "Recived medication", "Ever diagnosed with Bilharzia"),
#dep.var.labels = "",
type = "latex",
digit.separator = "",
no.space = TRUE,
column.sep.width = "3pt",
out = "logit_model_02_table.tex")  # Omit some statistics
# Extract coefficients
coefficients_02 <- coef(logit_model_02)
# Calculate odds ratios
odds_ratios_02 <- exp(coefficients_02)
# Display odds ratios in long format for better readability
odds_ratios_long_02 <- data.frame(
Variable = c("Intercept",
"Perceived infection",
"Missed school days",
"Received medication",
"Ever diagnosed with Bilharzia"),
Odds_Ratio = odds_ratios_02
)
# Use stargazer for a "long" table
stargazer(odds_ratios_long_02,
summary = FALSE,   # Suppresses summary statistics
type = "latex",
rownames = FALSE, #Removes row numbers
out = "odds_ratios_long.tex")
# Calculate confidence intervals for coefficients
conf_int <- confint(logit_model_02)
# Exponentiate to get confidence intervals for odds ratios
conf_int_odds_ratios_02 <- exp(conf_int)
# Display odds ratios with confidence intervals
CI_odds_02 <- data.frame(Odds_Ratio = odds_ratios_02,
CI_Lower = conf_int_odds_ratios_02[, 1],
CI_Upper = conf_int_odds_ratios_02[, 2])
stargazer(CI_odds_02,
type = "latex",
out = "CI_odds_02.tex")
setwd("C:/Users/km978/Box/NSF Senegal/Data Management/Output/Data Analysis/Parasitological Predictive Tables")
# Specify the formula for logistic regression
formula_02 <- sh_inf ~ health_5_3_2_ + health_5_4_ + health_5_5_ + health_5_6_
# Run the logistic regression
logit_model_02 <- glm(formula, data = matched_only_df, family = binomial)
#covariate_labels <- c("Perception", "Recently infected")
# Display summary of the model
stargazer(logit_model_02,
covariate.labels = c("Percieved infection", "Missed school days", "Recived medication", "Ever diagnosed with Bilharzia"),
#dep.var.labels = "",
type = "latex",
digit.separator = "",
no.space = TRUE,
column.sep.width = "3pt",
out = "logit_model_02_table.tex")  # Omit some statistics
# Extract coefficients
coefficients_02 <- coef(logit_model_02)
# Calculate odds ratios
odds_ratios_02 <- exp(coefficients_02)
# Display odds ratios in long format for better readability
odds_ratios_long_02 <- data.frame(
Variable = c("Intercept",
"Perceived infection",
"Missed school days",
"Received medication",
"Ever diagnosed with Bilharzia"),
Odds_Ratio = odds_ratios_02
)
# Use stargazer for a "long" table
stargazer(odds_ratios_long_02,
summary = FALSE,   # Suppresses summary statistics
type = "latex",
rownames = FALSE, #Removes row numbers
out = "odds_ratios_long.tex")
# Calculate confidence intervals for coefficients
conf_int <- confint(logit_model_02)
# Exponentiate to get confidence intervals for odds ratios
conf_int_odds_ratios_02 <- exp(conf_int)
# Display odds ratios with confidence intervals
CI_odds_02 <- data.frame(Odds_Ratio = odds_ratios_02,
CI_Lower = conf_int_odds_ratios_02[, 1],
CI_Upper = conf_int_odds_ratios_02[, 2])
stargazer(CI_odds_02,
type = "latex",
out = "CI_odds_02.tex")
setwd("C:/Users/km978/Box/NSF Senegal/Data Management/Output/Data Analysis/Parasitological Predictive Tables")
# Specify the formula for logistic regression
formula_01 <- sh_inf ~ health_5_3_2_ + health_5_4_
# Run the logistic regression
logit_model_01 <- glm(formula, data = matched_only_df, family = binomial)
#covariate_labels <- c("Perception", "Recently infected")
# Display summary of the model
stargazer(logit_model_01,
covariate.labels = c("Percieved infection", "Missed school days"),
#dep.var.labels = "",
type = "latex",
digit.separator = "",
no.space = TRUE,
column.sep.width = "3pt",
out = "logit_model_01_table.tex")  # Omit some statistics
# Extract coefficients
coefficients_01 <- coef(logit_model_01)
# Calculate odds ratios
odds_ratios_01 <- exp(coefficients_01)
# Display odds ratios
# Display odds ratios in long format for better readability
odds_ratios_long_01 <- data.frame(
Variable = c("Intercept",
"Perceived infection",
"Missed school days"),
Odds_Ratio = odds_ratios_01
)
setwd("C:/Users/km978/Box/NSF Senegal/Data Management/Output/Data Analysis/Parasitological Predictive Tables")
# Specify the formula for logistic regression
formula_02 <- sh_inf ~ health_5_3_2_ + health_5_4_ + health_5_5_ + health_5_6_
# Run the logistic regression
logit_model_02 <- glm(formula, data = matched_only_df, family = binomial)
#covariate_labels <- c("Perception", "Recently infected")
# Display summary of the model
stargazer(logit_model_02,
covariate.labels = c("Percieved infection", "Missed school days", "Recived medication", "Ever diagnosed with Bilharzia"),
#dep.var.labels = "",
type = "latex",
digit.separator = "",
no.space = TRUE,
column.sep.width = "3pt",
out = "logit_model_02_table.tex")  # Omit some statistics
# Extract coefficients
coefficients_02 <- coef(logit_model_02)
# Calculate odds ratios
odds_ratios_02 <- exp(coefficients_02)
# Display odds ratios in long format for better readability
odds_ratios_long_02 <- data.frame(
Variable = c("Intercept",
"Perceived infection",
"Missed school days",
"Received medication",
"Ever diagnosed with Bilharzia"),
Odds_Ratio = odds_ratios_02
)
# Use stargazer for a "long" table
stargazer(odds_ratios_long_02,
summary = FALSE,   # Suppresses summary statistics
type = "latex",
rownames = FALSE, #Removes row numbers
out = "odds_ratios_long.tex")
# Calculate confidence intervals for coefficients
conf_int <- confint(logit_model_02)
# Exponentiate to get confidence intervals for odds ratios
conf_int_odds_ratios_02 <- exp(conf_int)
# Display odds ratios with confidence intervals
CI_odds_02 <- data.frame(Odds_Ratio = odds_ratios_02,
CI_Lower = conf_int_odds_ratios_02[, 1],
CI_Upper = conf_int_odds_ratios_02[, 2])
stargazer(CI_odds_02,
type = "latex",
out = "CI_odds_02.tex")
setwd("C:/Users/km978/Box/NSF Senegal/Data Management/Output/Data Analysis/Parasitological Predictive Tables")
# Specify the formula for logistic regression
formula_01 <- sh_inf ~ health_5_3_2_ + health_5_4_
# Run the logistic regression
logit_model_01 <- glm(formula_01, data = matched_only_df, family = binomial)
#covariate_labels <- c("Perception", "Recently infected")
# Display summary of the model
stargazer(logit_model_01,
covariate.labels = c("Percieved infection", "Missed school days"),
#dep.var.labels = "",
type = "latex",
digit.separator = "",
no.space = TRUE,
column.sep.width = "3pt",
out = "logit_model_01_table.tex")  # Omit some statistics
# Extract coefficients
coefficients_01 <- coef(logit_model_01)
# Calculate odds ratios
odds_ratios_01 <- exp(coefficients_01)
# Display odds ratios
# Display odds ratios in long format for better readability
odds_ratios_long_01 <- data.frame(
Variable = c("Intercept",
"Perceived infection",
"Missed school days"),
Odds_Ratio = odds_ratios_01
)
# Use stargazer for a "long" table
stargazer(odds_ratios_long_01,
summary = FALSE,   # Suppresses summary statistics
type = "latex",
rownames = FALSE, #Removes row numbers
out = "odds_ratios_01.tex")
# Calculate confidence intervals for coefficients
conf_int_01 <- confint(logit_model_01)
# Exponentiate to get confidence intervals for odds ratios
conf_int_odds_ratios_01 <- exp(conf_int_01)
# Display odds ratios with confidence intervals
CI_odds_01 <- data.frame(Odds_Ratio = odds_ratios_01,
CI_Lower = conf_int_odds_ratios[, 1],
CI_Upper = conf_int_odds_ratios[, 2])
setwd("C:/Users/km978/Box/NSF Senegal/Data Management/Output/Data Analysis/Parasitological Predictive Tables")
# Specify the formula for logistic regression
formula_01 <- sh_inf ~ health_5_3_2_ + health_5_4_
# Run the logistic regression
logit_model_01 <- glm(formula_01, data = matched_only_df, family = binomial)
#covariate_labels <- c("Perception", "Recently infected")
# Display summary of the model
stargazer(logit_model_01,
covariate.labels = c("Percieved infection", "Missed school days"),
#dep.var.labels = "",
type = "latex",
digit.separator = "",
no.space = TRUE,
column.sep.width = "3pt",
out = "logit_model_01_table.tex")  # Omit some statistics
# Extract coefficients
coefficients_01 <- coef(logit_model_01)
# Calculate odds ratios
odds_ratios_01 <- exp(coefficients_01)
# Display odds ratios
# Display odds ratios in long format for better readability
odds_ratios_long_01 <- data.frame(
Variable = c("Intercept",
"Perceived infection",
"Missed school days"),
Odds_Ratio = odds_ratios_01
)
# Use stargazer for a "long" table
stargazer(odds_ratios_long_01,
summary = FALSE,   # Suppresses summary statistics
type = "latex",
rownames = FALSE, #Removes row numbers
out = "odds_ratios_01.tex")
# Calculate confidence intervals for coefficients
conf_int_01 <- confint(logit_model_01)
# Exponentiate to get confidence intervals for odds ratios
conf_int_odds_ratios_01 <- exp(conf_int_01)
# Display odds ratios with confidence intervals
CI_odds_01 <- data.frame(Odds_Ratio = odds_ratios_01,
CI_Lower = conf_int_odds_ratios_01[, 1],
CI_Upper = conf_int_odds_ratios_01[, 2])
stargazer(CI_odds_01,
type = "text",
out = "CI_odds_01.tex")
setwd("C:/Users/km978/Box/NSF Senegal/Data Management/Output/Data Analysis/Parasitological Predictive Tables")
# Specify the formula for logistic regression
formula_01 <- sh_inf ~ health_5_3_2_ + health_5_4_
# Run the logistic regression
logit_model_01 <- glm(formula_01, data = matched_only_df, family = binomial)
#covariate_labels <- c("Perception", "Recently infected")
# Display summary of the model
stargazer(logit_model_01,
covariate.labels = c("Percieved infection", "Missed school days"),
#dep.var.labels = "",
type = "latex",
digit.separator = "",
no.space = TRUE,
column.sep.width = "3pt",
out = "logit_model_01_table.tex")  # Omit some statistics
# Extract coefficients
coefficients_01 <- coef(logit_model_01)
# Calculate odds ratios
odds_ratios_01 <- exp(coefficients_01)
# Display odds ratios
# Display odds ratios in long format for better readability
odds_ratios_long_01 <- data.frame(
Variable = c("Intercept",
"Perceived infection",
"Missed school days"),
Odds_Ratio = odds_ratios_01
)
# Use stargazer for a "long" table
stargazer(odds_ratios_long_01,
summary = FALSE,   # Suppresses summary statistics
type = "latex",
rownames = FALSE, #Removes row numbers
out = "odds_ratios_01.tex")
# Calculate confidence intervals for coefficients
conf_int_01 <- confint(logit_model_01)
# Exponentiate to get confidence intervals for odds ratios
conf_int_odds_ratios_01 <- exp(conf_int_01)
# Display odds ratios with confidence intervals
CI_odds_01 <- data.frame(Odds_Ratio = odds_ratios_01,
CI_Lower = conf_int_odds_ratios_01[, 1],
CI_Upper = conf_int_odds_ratios_01[, 2])
stargazer(CI_odds_01,
type = "latex",
out = "CI_odds_01.tex")
