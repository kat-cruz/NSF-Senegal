)
)
output_categ
output_categ <- output_categ %>%
mutate(
Value = case_when(
Variable == "hh_gender" & Value == 0 ~ "Male/Female",
Variable == "health_5_3_2" & Value == 2 ~ "",
Variable == "health_5_5" & Value == 5 ~ "Yes/No/I don't know",
Variable == "health_5_6" & Value == 6 ~ "Yes/No/I don't know",
Variable == "health_5_8" & Value == 8 ~ "Yes/No/I don't know",
Variable == "health_5_9" & Value == 9 ~ "Yes/No/I don't know",
Variable == "hh_12_1" & Value == 1 ~ "Fetched water for HH",
Variable == "hh_12_2" & Value == 2 ~ "Gave water to livestock",
Variable == "hh_12_3" & Value == 3 ~ "Fetched water for agriculture",
Variable == "hh_12_4" & Value == 4 ~ "Washed clothes",
Variable == "hh_12_5" & Value == 5 ~ "Did the dishes",
Variable == "hh_12_6" & Value == 6 ~ "Harvested aquatic vegetation",
Variable == "hh_12_7" & Value == 7 ~ "Swam/bathed",
Variable == "hh_12_8" & Value == 8 ~ "Played",
Variable == "hh_19_1" & Value == 1 ~ "Lake",
Variable == "hh_19_2" & Value == 2 ~ "Pond",
Variable == "hh_19_3" & Value == 3 ~ "River",
Variable == "hh_19_4" & Value == 4 ~ "Irrigation channel",
Variable == "hh_19_99" & Value == 99 ~ "Other, give details",
Variable == "hh_31_1" & Value == 1 ~ "Graduated, studies completed",
Variable == "hh_31_2" & Value == 2 ~ "Moving to the next class",
Variable == "hh_31_3" & Value == 3 ~ "Failure, repetition",
Variable == "hh_31_4" & Value == 4 ~ "Failure, dismissal",
Variable == "hh_31_5" & Value == 5 ~ "Dropping out during the year",
Variable == "hh_33_1" & Value == 1 ~ "Lower",
Variable == "hh_33_2" & Value == 2 ~ "About the same",
Variable == "hh_33_3" & Value == 3 ~ "Superior",
Variable == "living_01_1" & Value == 1 ~ "Interior tap",
Variable == "living_01_2" & Value == 2 ~ "Public tap",
Variable == "living_01_3" & Value == 3 ~ "Neighbor’s tap",
Variable == "living_01_4" & Value == 4 ~ "Protected well",
Variable == "living_01_5" & Value == 5 ~ "Unprotected well",
Variable == "living_01_6" & Value == 6 ~ "Drill hole",
Variable == "living_01_7" & Value == 7 ~ "Tanker service",
Variable == "living_01_8" & Value == 8 ~ "Water seller",
Variable == "living_01_9" & Value == 9 ~ "Source",
Variable == "living_01_10" & Value == 10 ~ "Stream",
Variable == "living_01_99" & Value == 99 ~ "Other",
Variable == "living_03_1" & Value == 1 ~ "Bleach/Aqua tabs",
Variable == "living_03_2" & Value == 2 ~ "Boil",
Variable == "living_03_3" & Value == 3 ~ "Filtration",
Variable == "living_03_99" & Value == 99 ~ "Other (to be specified)",
Variable == "living_04_1" & Value == 1 ~ "None/outside",
Variable == "living_04_2" & Value == 2 ~ "Flush with sewer",
Variable == "living_04_3" & Value == 3 ~ "Toilet flush with septic tank",
Variable == "living_04_4" & Value == 4 ~ "Bucket",
Variable == "living_04_5" & Value == 5 ~ "Covered pit latrines",
Variable == "living_04_6" & Value == 6 ~ "Uncovered pit latrines",
Variable == "living_04_7" & Value == 7 ~ "Improved latrines",
Variable == "living_04_99" & Value == 99 ~ "Others",
TRUE ~ as.character(Value)  # Keep other values as they are
)
)
output_categ
output_categ <- output_categ %>%
mutate(
Value = case_when(
Variable == "hh_gender" & Value == NA ~ "Male/Female",
Variable == "health_5_3_2" & Value == 2 ~ "",
Variable == "health_5_5" & Value == 5 ~ "Yes/No/I don't know",
Variable == "health_5_6" & Value == 6 ~ "Yes/No/I don't know",
Variable == "health_5_8" & Value == 8 ~ "Yes/No/I don't know",
Variable == "health_5_9" & Value == 9 ~ "Yes/No/I don't know",
Variable == "hh_12_1" & Value == 1 ~ "Fetched water for HH",
Variable == "hh_12_2" & Value == 2 ~ "Gave water to livestock",
Variable == "hh_12_3" & Value == 3 ~ "Fetched water for agriculture",
Variable == "hh_12_4" & Value == 4 ~ "Washed clothes",
Variable == "hh_12_5" & Value == 5 ~ "Did the dishes",
Variable == "hh_12_6" & Value == 6 ~ "Harvested aquatic vegetation",
Variable == "hh_12_7" & Value == 7 ~ "Swam/bathed",
Variable == "hh_12_8" & Value == 8 ~ "Played",
Variable == "hh_19_1" & Value == 1 ~ "Lake",
Variable == "hh_19_2" & Value == 2 ~ "Pond",
Variable == "hh_19_3" & Value == 3 ~ "River",
Variable == "hh_19_4" & Value == 4 ~ "Irrigation channel",
Variable == "hh_19_99" & Value == 99 ~ "Other, give details",
Variable == "hh_31_1" & Value == 1 ~ "Graduated, studies completed",
Variable == "hh_31_2" & Value == 2 ~ "Moving to the next class",
Variable == "hh_31_3" & Value == 3 ~ "Failure, repetition",
Variable == "hh_31_4" & Value == 4 ~ "Failure, dismissal",
Variable == "hh_31_5" & Value == 5 ~ "Dropping out during the year",
Variable == "hh_33_1" & Value == 1 ~ "Lower",
Variable == "hh_33_2" & Value == 2 ~ "About the same",
Variable == "hh_33_3" & Value == 3 ~ "Superior",
Variable == "living_01_1" & Value == 1 ~ "Interior tap",
Variable == "living_01_2" & Value == 2 ~ "Public tap",
Variable == "living_01_3" & Value == 3 ~ "Neighbor’s tap",
Variable == "living_01_4" & Value == 4 ~ "Protected well",
Variable == "living_01_5" & Value == 5 ~ "Unprotected well",
Variable == "living_01_6" & Value == 6 ~ "Drill hole",
Variable == "living_01_7" & Value == 7 ~ "Tanker service",
Variable == "living_01_8" & Value == 8 ~ "Water seller",
Variable == "living_01_9" & Value == 9 ~ "Source",
Variable == "living_01_10" & Value == 10 ~ "Stream",
Variable == "living_01_99" & Value == 99 ~ "Other",
Variable == "living_03_1" & Value == 1 ~ "Bleach/Aqua tabs",
Variable == "living_03_2" & Value == 2 ~ "Boil",
Variable == "living_03_3" & Value == 3 ~ "Filtration",
Variable == "living_03_99" & Value == 99 ~ "Other (to be specified)",
Variable == "living_04_1" & Value == 1 ~ "None/outside",
Variable == "living_04_2" & Value == 2 ~ "Flush with sewer",
Variable == "living_04_3" & Value == 3 ~ "Toilet flush with septic tank",
Variable == "living_04_4" & Value == 4 ~ "Bucket",
Variable == "living_04_5" & Value == 5 ~ "Covered pit latrines",
Variable == "living_04_6" & Value == 6 ~ "Uncovered pit latrines",
Variable == "living_04_7" & Value == 7 ~ "Improved latrines",
Variable == "living_04_99" & Value == 99 ~ "Others",
TRUE ~ as.character(Value)  # Keep other values as they are
)
)
output_categ
output_categ <- output_categ %>%
mutate(
Value = case_when(
Variable == "hh_gender" & is.na(Value) ~ "Male/Female"
Variable == "health_5_3_2" & Value == 2 ~ "N/A",
output_categ
# Define possible paths
path1 <- "C:/Users/Kateri/Downloads/SenegalGIT/Scripts/Latex_Output/Parasitological_Predictive_Analysis"
path2 <- "C:/Users/km978/Downloads/SenegalGIT/Scripts/Latex_Output/Parasitological_Predictive_Analysis"
# set the working directory
if (dir.exists(path1)) {
setwd(path1)
} else if (dir.exists(path2)) {
setwd(path2)
}
#Remove 2s
binary_df <- binary_df %>%
mutate(
health_5_3_2_ = if_else(health_5_3_2_ == 2, NA_real_, health_5_3_2_),
health_5_5_ = if_else(health_5_5_ == 2, NA_real_, health_5_5_),
health_5_6_ = if_else(health_5_6_ == 2, NA_real_, health_5_6_),
health_5_8_ = if_else(health_5_8_ == 2, NA_real_, health_5_8_),
health_5_9_ = if_else(health_5_9_ == 2, NA_real_, health_5_9_)
) %>%
filter(!is.na(health_5_3_2_) & !is.na(health_5_5_) & !is.na(health_5_6_) &
!is.na(health_5_8_) & !is.na(health_5_9_))
# Define the prefixes
prefixes_categ <- c("hh_gender_", "health_5_3_2_", "health_5_5_", "health_5_6_", "health_5_8_","health_5_9_", "hh_12_1_", "hh_12_2_", "hh_12_3_", "hh_12_4_", "hh_12_5_", "hh_12_6_", "hh_12_7_",  "hh_12_8_", "hh_19_1", "hh_19_2", "hh_19_3", "hh_19_4", "hh_19_99",
"hh_31_1", "hh_31_2", "hh_31_3", "hh_31_4", "hh_31_5",
"hh_33_1", "hh_33_2", "hh_33_3","living_01_1", "living_01_2", "living_01_3", "living_01_4", "living_01_5",
"living_01_6", "living_01_7", "living_01_8", "living_01_9", "living_01_10", "living_01_99",
"living_03_1", "living_03_2", "living_03_3", "living_03_99",
"living_04_1", "living_04_2", "living_04_3", "living_04_4", "living_04_5",
"living_04_6", "living_04_7", "living_04_99")
# Generate categorical summary
output_categ <- as.data.frame(binary_summary_l(binary_df, prefixes_categ))
rownames(output_categ) <- NULL
output_categ
output_categ <- output_categ %>%
mutate(
Variable = str_replace(Variable, "_$", "")
) %>%
mutate(
Value = str_extract(Variable, "(?<=_)\\d+$")  # Extract the number at the end of the variable
)
output_categ
output_categ <- output_categ %>%
mutate(
Value = case_when(
Variable == "hh_gender" & is.na(Value) ~ "Male/Female"
Variable == "health_5_3_2" & Value == 2 ~ "N/A",
# Define possible paths
path1 <- "C:/Users/Kateri/Downloads/SenegalGIT/Scripts/Latex_Output/Parasitological_Predictive_Analysis"
path2 <- "C:/Users/km978/Downloads/SenegalGIT/Scripts/Latex_Output/Parasitological_Predictive_Analysis"
# set the working directory
if (dir.exists(path1)) {
setwd(path1)
} else if (dir.exists(path2)) {
setwd(path2)
}
#Remove 2s
binary_df <- binary_df %>%
mutate(
health_5_3_2_ = if_else(health_5_3_2_ == 2, NA_real_, health_5_3_2_),
health_5_5_ = if_else(health_5_5_ == 2, NA_real_, health_5_5_),
health_5_6_ = if_else(health_5_6_ == 2, NA_real_, health_5_6_),
health_5_8_ = if_else(health_5_8_ == 2, NA_real_, health_5_8_),
health_5_9_ = if_else(health_5_9_ == 2, NA_real_, health_5_9_)
) %>%
filter(!is.na(health_5_3_2_) & !is.na(health_5_5_) & !is.na(health_5_6_) &
!is.na(health_5_8_) & !is.na(health_5_9_))
# Define the prefixes
prefixes_categ <- c("hh_gender_", "health_5_3_2_", "health_5_5_", "health_5_6_", "health_5_8_","health_5_9_", "hh_12_1_", "hh_12_2_", "hh_12_3_", "hh_12_4_", "hh_12_5_", "hh_12_6_", "hh_12_7_",  "hh_12_8_", "hh_19_1", "hh_19_2", "hh_19_3", "hh_19_4", "hh_19_99",
"hh_31_1", "hh_31_2", "hh_31_3", "hh_31_4", "hh_31_5",
"hh_33_1", "hh_33_2", "hh_33_3","living_01_1", "living_01_2", "living_01_3", "living_01_4", "living_01_5",
"living_01_6", "living_01_7", "living_01_8", "living_01_9", "living_01_10", "living_01_99",
"living_03_1", "living_03_2", "living_03_3", "living_03_99",
"living_04_1", "living_04_2", "living_04_3", "living_04_4", "living_04_5",
"living_04_6", "living_04_7", "living_04_99")
# Generate categorical summary
output_categ <- as.data.frame(binary_summary_l(binary_df, prefixes_categ))
rownames(output_categ) <- NULL
output_categ
output_categ <- output_categ %>%
mutate(
Variable = str_replace(Variable, "_$", "")
) %>%
mutate(
Value = str_extract(Variable, "(?<=_)\\d+$")  # Extract the number at the end of the variable
)
output_categ
output_categ <- output_categ %>%
mutate(
Value = case_when(
Variable == "hh_gender" & is.na(Value) ~ "Male/Female"
Variable == "health_5_3_2" & Value == 2 ~ "N/A",
# Define possible paths
path1 <- "C:/Users/Kateri/Downloads/SenegalGIT/Scripts/Latex_Output/Parasitological_Predictive_Analysis"
path2 <- "C:/Users/km978/Downloads/SenegalGIT/Scripts/Latex_Output/Parasitological_Predictive_Analysis"
# set the working directory
if (dir.exists(path1)) {
setwd(path1)
} else if (dir.exists(path2)) {
setwd(path2)
}
#Remove 2s
binary_df <- binary_df %>%
mutate(
health_5_3_2_ = if_else(health_5_3_2_ == 2, NA_real_, health_5_3_2_),
health_5_5_ = if_else(health_5_5_ == 2, NA_real_, health_5_5_),
health_5_6_ = if_else(health_5_6_ == 2, NA_real_, health_5_6_),
health_5_8_ = if_else(health_5_8_ == 2, NA_real_, health_5_8_),
health_5_9_ = if_else(health_5_9_ == 2, NA_real_, health_5_9_)
) %>%
filter(!is.na(health_5_3_2_) & !is.na(health_5_5_) & !is.na(health_5_6_) &
!is.na(health_5_8_) & !is.na(health_5_9_))
# Define the prefixes
prefixes_categ <- c("hh_gender_", "health_5_3_2_", "health_5_5_", "health_5_6_", "health_5_8_","health_5_9_", "hh_12_1_", "hh_12_2_", "hh_12_3_", "hh_12_4_", "hh_12_5_", "hh_12_6_", "hh_12_7_",  "hh_12_8_", "hh_19_1", "hh_19_2", "hh_19_3", "hh_19_4", "hh_19_99",
"hh_31_1", "hh_31_2", "hh_31_3", "hh_31_4", "hh_31_5",
"hh_33_1", "hh_33_2", "hh_33_3","living_01_1", "living_01_2", "living_01_3", "living_01_4", "living_01_5",
"living_01_6", "living_01_7", "living_01_8", "living_01_9", "living_01_10", "living_01_99",
"living_03_1", "living_03_2", "living_03_3", "living_03_99",
"living_04_1", "living_04_2", "living_04_3", "living_04_4", "living_04_5",
"living_04_6", "living_04_7", "living_04_99")
# Generate categorical summary
output_categ <- as.data.frame(binary_summary_l(binary_df, prefixes_categ))
rownames(output_categ) <- NULL
output_categ
output_categ <- output_categ %>%
mutate(
Variable = str_replace(Variable, "_$", "")
) %>%
mutate(
Value = str_extract(Variable, "(?<=_)\\d+$")  # Extract the number at the end of the variable
)
output_categ
output_categ <- output_categ %>%
mutate(
Value = case_when(
Variable == "hh_gender" & is.na(Value) ~ "Male/Female",
Variable == "health_5_3_2" & Value == 2 ~ "N/A",
Variable == "health_5_5" & Value == 5 ~ "Yes/No/I don't know",
Variable == "health_5_6" & Value == 6 ~ "Yes/No/I don't know",
Variable == "health_5_8" & Value == 8 ~ "Yes/No/I don't know",
Variable == "health_5_9" & Value == 9 ~ "Yes/No/I don't know",
Variable == "hh_12_1" & Value == 1 ~ "Fetched water for HH",
Variable == "hh_12_2" & Value == 2 ~ "Gave water to livestock",
Variable == "hh_12_3" & Value == 3 ~ "Fetched water for agriculture",
Variable == "hh_12_4" & Value == 4 ~ "Washed clothes",
Variable == "hh_12_5" & Value == 5 ~ "Did the dishes",
Variable == "hh_12_6" & Value == 6 ~ "Harvested aquatic vegetation",
Variable == "hh_12_7" & Value == 7 ~ "Swam/bathed",
Variable == "hh_12_8" & Value == 8 ~ "Played",
Variable == "hh_19_1" & Value == 1 ~ "Lake",
Variable == "hh_19_2" & Value == 2 ~ "Pond",
Variable == "hh_19_3" & Value == 3 ~ "River",
Variable == "hh_19_4" & Value == 4 ~ "Irrigation channel",
Variable == "hh_19_99" & Value == 99 ~ "Other, give details",
Variable == "hh_31_1" & Value == 1 ~ "Graduated, studies completed",
Variable == "hh_31_2" & Value == 2 ~ "Moving to the next class",
Variable == "hh_31_3" & Value == 3 ~ "Failure, repetition",
Variable == "hh_31_4" & Value == 4 ~ "Failure, dismissal",
Variable == "hh_31_5" & Value == 5 ~ "Dropping out during the year",
Variable == "hh_33_1" & Value == 1 ~ "Lower",
Variable == "hh_33_2" & Value == 2 ~ "About the same",
Variable == "hh_33_3" & Value == 3 ~ "Superior",
Variable == "living_01_1" & Value == 1 ~ "Interior tap",
Variable == "living_01_2" & Value == 2 ~ "Public tap",
Variable == "living_01_3" & Value == 3 ~ "Neighbor’s tap",
Variable == "living_01_4" & Value == 4 ~ "Protected well",
Variable == "living_01_5" & Value == 5 ~ "Unprotected well",
Variable == "living_01_6" & Value == 6 ~ "Drill hole",
Variable == "living_01_7" & Value == 7 ~ "Tanker service",
Variable == "living_01_8" & Value == 8 ~ "Water seller",
Variable == "living_01_9" & Value == 9 ~ "Source",
Variable == "living_01_10" & Value == 10 ~ "Stream",
Variable == "living_01_99" & Value == 99 ~ "Other",
Variable == "living_03_1" & Value == 1 ~ "Bleach/Aqua tabs",
Variable == "living_03_2" & Value == 2 ~ "Boil",
Variable == "living_03_3" & Value == 3 ~ "Filtration",
Variable == "living_03_99" & Value == 99 ~ "Other (to be specified)",
Variable == "living_04_1" & Value == 1 ~ "None/outside",
Variable == "living_04_2" & Value == 2 ~ "Flush with sewer",
Variable == "living_04_3" & Value == 3 ~ "Toilet flush with septic tank",
Variable == "living_04_4" & Value == 4 ~ "Bucket",
Variable == "living_04_5" & Value == 5 ~ "Covered pit latrines",
Variable == "living_04_6" & Value == 6 ~ "Uncovered pit latrines",
Variable == "living_04_7" & Value == 7 ~ "Improved latrines",
Variable == "living_04_99" & Value == 99 ~ "Others",
TRUE ~ as.character(Value)  # Keep other values as they are
)
)
# ) %>%
#
#   filter(Value != 0)
output_categ <- output_categ %>%
mutate(
Survey_Question = case_when(
str_detect(Variable, "^hh_gender") ~ "Gender of respondent?",
str_detect(Variable, "^health_5_3_2") ~ "Had Bilharzia past 12 months?",
str_detect(Variable, "^health_5_5") ~ "Has he/she received medication for the treatment of schistosomiasis in the past 12 months?",
str_detect(Variable, "^health_5_6") ~ "Has this person ever been diagnosed with schistosomiasis?",
str_detect(Variable, "^health_5_8") ~ "Has this person had blood in their urine in the past 12 months?",
str_detect(Variable, "^health_5_9") ~ "Has this person had blood in their stools in the past 12 months?",
str_detect(Variable, "^hh_12_") ~ "In the past 12 months, why did [Name] spend time near (< 1 m) or in the water source(s)?",
str_detect(Variable, "^hh_19_") ~ "What source(s) of surface water?",
str_detect(Variable, "^hh_31_") ~ "What result did [Name] achieve in the year 2022/2023?",
str_detect(Variable, "^hh_33_") ~ "How does [Name]'s academic performance compare to other students: lower, the same, or higher?",
str_detect(Variable, "^living_01") ~ "What is the main source of drinking water supply?",
str_detect(Variable, "^living_03") ~ "If yes, how is the water treated?",
str_detect(Variable, "^living_04") ~ "What is the main type of toilet used by your household?",
TRUE ~ NA_character_  # Assign NA if no match
)
) %>%
relocate(Survey_Question, .before = Variable) %>%
relocate(Value, .before = N)
output_categ <- output_categ %>%
select(-prop_na)
# Create the gt table
output_categ_gt <- gt(output_categ) %>%
tab_header(
title = "Binary Variable Summary Statistics"
)
gtsave(output_categ_gt, "binary_summary_stats.tex")
output_categ_gt
output_categ
# Define possible paths
path1 <- "C:/Users/Kateri/Downloads/SenegalGIT/Scripts/Latex_Output/Parasitological_Predictive_Analysis"
path2 <- "C:/Users/km978/Downloads/SenegalGIT/Scripts/Latex_Output/Parasitological_Predictive_Analysis"
# set the working directory
if (dir.exists(path1)) {
setwd(path1)
} else if (dir.exists(path2)) {
setwd(path2)
}
#Remove 2s
binary_df <- binary_df %>%
mutate(
health_5_3_2_ = if_else(health_5_3_2_ == 2, NA_real_, health_5_3_2_),
health_5_5_ = if_else(health_5_5_ == 2, NA_real_, health_5_5_),
health_5_6_ = if_else(health_5_6_ == 2, NA_real_, health_5_6_),
health_5_8_ = if_else(health_5_8_ == 2, NA_real_, health_5_8_),
health_5_9_ = if_else(health_5_9_ == 2, NA_real_, health_5_9_)
) %>%
filter(!is.na(health_5_3_2_) & !is.na(health_5_5_) & !is.na(health_5_6_) &
!is.na(health_5_8_) & !is.na(health_5_9_)) %>%
mutate(hh_gender_ = recode(hh_gender_, `2` = 0, .default = hh_gender_))
# Define the prefixes
prefixes_categ <- c("hh_gender_", "health_5_3_2_", "health_5_5_", "health_5_6_", "health_5_8_","health_5_9_", "hh_12_1_", "hh_12_2_", "hh_12_3_", "hh_12_4_", "hh_12_5_", "hh_12_6_", "hh_12_7_",  "hh_12_8_", "hh_19_1", "hh_19_2", "hh_19_3", "hh_19_4", "hh_19_99",
"hh_31_1", "hh_31_2", "hh_31_3", "hh_31_4", "hh_31_5",
"hh_33_1", "hh_33_2", "hh_33_3","living_01_1", "living_01_2", "living_01_3", "living_01_4", "living_01_5",
"living_01_6", "living_01_7", "living_01_8", "living_01_9", "living_01_10", "living_01_99",
"living_03_1", "living_03_2", "living_03_3", "living_03_99",
"living_04_1", "living_04_2", "living_04_3", "living_04_4", "living_04_5",
"living_04_6", "living_04_7", "living_04_99")
# Generate categorical summary
output_categ <- as.data.frame(binary_summary_l(binary_df, prefixes_categ))
rownames(output_categ) <- NULL
output_categ
output_categ <- output_categ %>%
mutate(
Variable = str_replace(Variable, "_$", "")
) %>%
mutate(
Value = str_extract(Variable, "(?<=_)\\d+$")  # Extract the number at the end of the variable
)
output_categ
output_categ <- output_categ %>%
mutate(
Value = case_when(
Variable == "hh_gender" & is.na(Value) ~ "Male/Female",
Variable == "health_5_3_2" & Value == 2 ~ "N/A",
Variable == "health_5_5" & Value == 5 ~ "Yes/No/I don't know",
Variable == "health_5_6" & Value == 6 ~ "Yes/No/I don't know",
Variable == "health_5_8" & Value == 8 ~ "Yes/No/I don't know",
Variable == "health_5_9" & Value == 9 ~ "Yes/No/I don't know",
Variable == "hh_12_1" & Value == 1 ~ "Fetched water for HH",
Variable == "hh_12_2" & Value == 2 ~ "Gave water to livestock",
Variable == "hh_12_3" & Value == 3 ~ "Fetched water for agriculture",
Variable == "hh_12_4" & Value == 4 ~ "Washed clothes",
Variable == "hh_12_5" & Value == 5 ~ "Did the dishes",
Variable == "hh_12_6" & Value == 6 ~ "Harvested aquatic vegetation",
Variable == "hh_12_7" & Value == 7 ~ "Swam/bathed",
Variable == "hh_12_8" & Value == 8 ~ "Played",
Variable == "hh_19_1" & Value == 1 ~ "Lake",
Variable == "hh_19_2" & Value == 2 ~ "Pond",
Variable == "hh_19_3" & Value == 3 ~ "River",
Variable == "hh_19_4" & Value == 4 ~ "Irrigation channel",
Variable == "hh_19_99" & Value == 99 ~ "Other, give details",
Variable == "hh_31_1" & Value == 1 ~ "Graduated, studies completed",
Variable == "hh_31_2" & Value == 2 ~ "Moving to the next class",
Variable == "hh_31_3" & Value == 3 ~ "Failure, repetition",
Variable == "hh_31_4" & Value == 4 ~ "Failure, dismissal",
Variable == "hh_31_5" & Value == 5 ~ "Dropping out during the year",
Variable == "hh_33_1" & Value == 1 ~ "Lower",
Variable == "hh_33_2" & Value == 2 ~ "About the same",
Variable == "hh_33_3" & Value == 3 ~ "Superior",
Variable == "living_01_1" & Value == 1 ~ "Interior tap",
Variable == "living_01_2" & Value == 2 ~ "Public tap",
Variable == "living_01_3" & Value == 3 ~ "Neighbor’s tap",
Variable == "living_01_4" & Value == 4 ~ "Protected well",
Variable == "living_01_5" & Value == 5 ~ "Unprotected well",
Variable == "living_01_6" & Value == 6 ~ "Drill hole",
Variable == "living_01_7" & Value == 7 ~ "Tanker service",
Variable == "living_01_8" & Value == 8 ~ "Water seller",
Variable == "living_01_9" & Value == 9 ~ "Source",
Variable == "living_01_10" & Value == 10 ~ "Stream",
Variable == "living_01_99" & Value == 99 ~ "Other",
Variable == "living_03_1" & Value == 1 ~ "Bleach/Aqua tabs",
Variable == "living_03_2" & Value == 2 ~ "Boil",
Variable == "living_03_3" & Value == 3 ~ "Filtration",
Variable == "living_03_99" & Value == 99 ~ "Other (to be specified)",
Variable == "living_04_1" & Value == 1 ~ "None/outside",
Variable == "living_04_2" & Value == 2 ~ "Flush with sewer",
Variable == "living_04_3" & Value == 3 ~ "Toilet flush with septic tank",
Variable == "living_04_4" & Value == 4 ~ "Bucket",
Variable == "living_04_5" & Value == 5 ~ "Covered pit latrines",
Variable == "living_04_6" & Value == 6 ~ "Uncovered pit latrines",
Variable == "living_04_7" & Value == 7 ~ "Improved latrines",
Variable == "living_04_99" & Value == 99 ~ "Others",
TRUE ~ as.character(Value)  # Keep other values as they are
)
)
# ) %>%
#
#   filter(Value != 0)
output_categ <- output_categ %>%
mutate(
Survey_Question = case_when(
str_detect(Variable, "^hh_gender") ~ "Gender of respondent?",
str_detect(Variable, "^health_5_3_2") ~ "Had Bilharzia past 12 months?",
str_detect(Variable, "^health_5_5") ~ "Has he/she received medication for the treatment of schistosomiasis in the past 12 months?",
str_detect(Variable, "^health_5_6") ~ "Has this person ever been diagnosed with schistosomiasis?",
str_detect(Variable, "^health_5_8") ~ "Has this person had blood in their urine in the past 12 months?",
str_detect(Variable, "^health_5_9") ~ "Has this person had blood in their stools in the past 12 months?",
str_detect(Variable, "^hh_12_") ~ "In the past 12 months, why did [Name] spend time near (< 1 m) or in the water source(s)?",
str_detect(Variable, "^hh_19_") ~ "What source(s) of surface water?",
str_detect(Variable, "^hh_31_") ~ "What result did [Name] achieve in the year 2022/2023?",
str_detect(Variable, "^hh_33_") ~ "How does [Name]'s academic performance compare to other students: lower, the same, or higher?",
str_detect(Variable, "^living_01") ~ "What is the main source of drinking water supply?",
str_detect(Variable, "^living_03") ~ "If yes, how is the water treated?",
str_detect(Variable, "^living_04") ~ "What is the main type of toilet used by your household?",
TRUE ~ NA_character_  # Assign NA if no match
)
) %>%
relocate(Survey_Question, .before = Variable) %>%
relocate(Value, .before = N)
output_categ <- output_categ %>%
select(-prop_na)
# Create the gt table
output_categ_gt <- gt(output_categ) %>%
tab_header(
title = "Binary Variable Summary Statistics"
)
gtsave(output_categ_gt, "binary_summary_stats.tex")
output_categ_gt
output_categ
# Function to calculate summary statistics for a single categorical vector
categ_func_l <- function(value_l) {
# N = Total number of non-empty, non-NA observations (including -9s but excluding true NAs/empty cells)
N <- sum(!is.na(value_l) & value_l != "")
# Remove NAs and invalid values (-9 in this example)
valid_value_l <- value_l[!is.na(value_l) & value_l != -9]
# Calculate frequency and proportion for valid responses
freq_table_l <- table(valid_value_l)
proportions_l <- round(freq_table_l / length(valid_value_l), 2)
# Calculate the proportion of -9s and NAs
prop_na_l <- round(sum(value_l == -9, na.rm = TRUE) / N, 2)
# Create a data frame with the summary
categorical_data_l <- data.frame(
Value = names(freq_table_l),
N = N,  # Total number of observations
Frequency = as.vector(freq_table_l),  # Frequency of valid responses
Proportion = as.vector(proportions_l),  # Proportion of valid responses
prop_na = prop_na_l  # Proportion of -9s/NAs
)
return(categorical_data_l)
}
# Function to summarize multiple categorical variables by prefix
categ_summary_l <- function(data_l, prefixes_l) {
summaries_l <- lapply(prefixes_l, function(prefix_l) {
variable_data_l <- data_l %>%
select(starts_with(prefix_l))
# Pull the 'value' column and pass to categ_func_l
value_l <- variable_data_l[[1]]
summary_categ_l <- categ_func_l(value_l)
summary_categ_l$Variable <- prefix_l  # Assign the prefix as the variable name
# Reorder columns so Variable is first
summary_categ_l <- summary_categ_l %>%
select(Variable, everything())
return(summary_categ_l)
})
categ_sum_set_l <- bind_rows(summaries_l)
return(categ_sum_set_l)
}
